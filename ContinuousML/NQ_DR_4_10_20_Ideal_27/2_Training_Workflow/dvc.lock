schema: '2.0'
stages:
  training:
    cmd:
    - python ../../../src/Model_Training/Model_Training.py
    - echo "# Multi Class Classification" >> report.md
    - echo "## Plots" >> report.md
    - git add \*.csv
    deps:
    - path: ../../../src/Model_Training/Model_Training.py
      md5: f5f8553a288cb1067528715c42a81688
      size: 11002
    - path: Reduced_Features.csv
      md5: 5d78c9925fc0f8e8117a91162219fd03
      size: 4482192
    params:
      params.yaml:
        epochs: 5
        hyp_tuning.activation:
        - relu
        - elu
        hyp_tuning.batch_size:
        - 64
        - 128
        - 256
        hyp_tuning.dropout:
        - 0.1
        - 0.5
        - 0.1
        hyp_tuning.hidden_units:
        - 32
        - 64
        - 128
        - 256
        hyp_tuning.learning_rate:
        - 0.0001
        - 0.01
        hyp_tuning.n_layers: 3
        hyp_tuning.num_trials: 5
        hyp_tuning.optimizer:
        - adam
        mode: hyp_tuning
        test_size: 0.2
        train.activation: relu
        train.batch_size: 128
        train.hidden_layers:
          n_units_l0: 128
          dropout_l0: 0.3
          n_units_l1: 128
          dropout_l1: 0.3
          n_units_l2: 64
        train.learning_rate: 0.003
        train.n_layers: 3
        train.optimizer: adam
    outs:
    - path: classes.csv
      md5: 350c3a5625003f3112e505b78aa5b12d
      size: 5899
    - path: keras_model.onnx
      md5: 5f00c06b8ff5dd3699a1a10a5f35e6e9
      size: 379266
    - path: train_metric
      md5: d4afd37c25603d0ffc3b824b1f044621.dir
      size: 1027
      nfiles: 5
